<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dino Game</title>
    <style>
        * { margin: 0; padding: 0; }
        body { 
            display: flex;
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            background: #222;
        }
        canvas { 
            border: 2px solid #fff;
        }
    </style>
</head>
<body>
    <!-- Main Canvas -->
    <canvas id="game" width="800" height="200"></canvas>
    <!-- Backup Canvas (Invisible for redundancy) -->
    <canvas id="backupCanvas" width="800" height="200" style="display:none;"></canvas>

    <script>
        const c = document.getElementById('game');
        const ctx = c.getContext('2d');

        // Backup Canvas and Context
        const backupCanvas = document.getElementById('backupCanvas');
        const backupCtx = backupCanvas.getContext('2d');
        
        let speed = 6, score = 0, high = 0, over = false, start = false;
        let obs = [], frame = 0, next = 100, space = 0, last = 0, fly = false;
        let god = false, keys = {u:false, d:false};
        let audioEnabled = false;

        // Corrected audio filenames
        const applause = new Audio('sounds/aplausos_2.mp3'); // Applause sound for milestones (1000)
        const celebration = new Audio('sounds/-audiotrimmer_adesehy.mp3'); // Same sound for 10000 and 20000 points
        const gameOverAudio = new Audio('sounds/directed-by-robert-b-vol2Z4T.mp3'); // Game Over sound

        // Create a "ding" sound using Web Audio API
        function createDing() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.type = 'sine'; // Type of sound (sine wave is smooth)
            oscillator.frequency.setValueAtTime(1000, audioContext.currentTime); // Set frequency (1000 Hz for a "ding")
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime); // Volume level (soft)
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.3); // Duration of the "ding" sound (300ms)
        }

        // Function to play the "ding" sound
        function playDingSound() {
            createDing();
        }

        // Start the game
        function startGame() {
            const dino = {
                x: 50, y: 150, w: 44, h: 47, dy: 0, jump: false, leg: 0, ty: 150,

                // Dino jump logic
                update() {
                    if (fly) {
                        if (keys.u) this.ty = Math.max(20, this.ty - 12);
                        if (keys.d) this.ty = Math.min(150, this.ty + 12);
                        this.y += (this.ty - this.y) * 0.4;
                    } else {
                        this.dy += 0.6;
                        this.y += this.dy;
                        if (this.y >= 150) {
                            this.y = 150;
                            this.dy = 0;
                            this.jump = false;
                        }
                    }
                    if (this.y >= 150 && frame % 5 === 0) this.leg = 1 - this.leg;
                },

                // Drawing the dino
                draw() {
                    ctx.fillStyle = fly ? '#0BF' : '#535';
                    ctx.fillRect(this.x + 20, this.y, 22, 22);
                    ctx.fillRect(this.x + 35, this.y + 10, 7, 12);
                    ctx.fillRect(this.x + 35, this.y + 2, 15, 10);
                    ctx.fillStyle = '#fff';
                    ctx.fillRect(this.x + 45, this.y + 4, 3, 3);
                    ctx.fillStyle = fly ? '#0BF' : '#535';
                    ctx.fillRect(this.x + 10, this.y + 18, 12, 4);
                    ctx.fillRect(this.x, this.y + 16, 12, 4);
                    if (this.leg === 0) {
                        ctx.fillRect(this.x + 20, this.y + 22, 6, 10);
                        ctx.fillRect(this.x + 30, this.y + 22, 6, 10);
                    } else {
                        ctx.fillRect(this.x + 22, this.y + 22, 6, 10);
                        ctx.fillRect(this.x + 28, this.y + 22, 6, 10);
                    }

                    if (fly) {
                        ctx.fillStyle = '#F80';
                        ctx.font = '16px Courier';
                        ctx.fillText('FLIGHT!', this.x - 10, this.y - 10);
                    }
                }
            };

            const clouds = [];
            for (let i = 0; i < 5; i++) {
                clouds.push({x: Math.random() * 800, y: Math.random() * 100, size: Math.random() * 40 + 20});
            }

            // Game Loop
            function gameLoop() {
                // Backup canvas
                backupCtx.clearRect(0, 0, 800, 200);
                backupCtx.drawImage(c, 0, 0);

                // Audio triggers based on score
                if (score >= 1000 && score % 1000 === 0 && audioEnabled) {
                    applause.play(); // Play applause sound for 1000 points and multiples of 1000
                }

                if (score % 100 === 0 && audioEnabled) {
                    playDingSound(); // Play the "ding" sound for every 100 points
                }

                if (score >= 10000 && score % 10000 === 0 && audioEnabled) {
                    celebration.play(); // Play same sound for both 10000 and 20000
                }

                // Check for Game Over
                if (over) {
                    ctx.fillStyle = '#000';
                    ctx.font = 'bold 28px Courier';
                    ctx.textAlign = 'center';
                    ctx.fillText('GAME OVER', 400, 80);
                    ctx.font = '18px Courier';
                    ctx.fillText('Press R to restart', 400, 110);
                    ctx.textAlign = 'right';
                    ctx.fillText('Score: ' + Math.floor(score), 790, 30);
                    ctx.fillText('High: ' + Math.floor(high), 790, 55);
                    if (audioEnabled) gameOverAudio.play(); // Play Game Over sound
                    return;
                }

                // Update Dino and Environment
                speed = Math.min(14, speed + 0.002);
                score += fly ? 250 / 60 : 100 / 120;
                dino.update();
                dino.draw();

                // Other game elements (cactus, shooting stars, etc.)
                next--;
                if (next <= 0) {
                    obs.push(new Cactus());
                    next = Math.random() * 20 + 30;
                }

                // Handle obstacles and collision
                obs = obs.filter(o => {
                    o.x -= speed;
                    o.draw();
                    if (!god && o.hits(dino)) {
                        over = true;
                        if (score > high) high = score;
                        if (audioEnabled) gameOverAudio.play(); // Play game over sound
                    }
                    return o.x > -50;
                });

                ctx.fillStyle = '#000';
                ctx.font = 'bold 18px Courier';
                ctx.textAlign = 'right';
                ctx.fillText('HI ' + String(Math.floor(high)).padStart(5, '0'), 790, 30);
                ctx.fillText(String(Math.floor(score)).padStart(5, '0'), 790, 55);

                frame++;
                requestAnimationFrame(gameLoop);
            }

            gameLoop();
        }
    </script>
</body>
</html>
