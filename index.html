<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dino Game</title>
    <style>
        * { margin: 0; padding: 0; }
        body { 
            display: flex;
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            background: #222;
            overflow: hidden;
        }
        canvas { 
            border: 2px solid #fff;
        }
    </style>
</head>
<body>
    <canvas id="game" width="800" height="200"></canvas>
    <script>
        const c = document.getElementById('game');
        const ctx = c.getContext('2d');
        
        let speed = 6, score = 0, high = 0, over = false, start = false;
        let obs = [], frame = 0, next = 100, biomeChange = 500;  // Cactus spawn interval and biome change interval
        let fly = false, god = false, space = 0, last = 0;
        let keys = {u:false, d:false};

        // Audio files
        const audioDing = new Audio('https://www.soundjay.com/button/beep-07.wav'); // Ding sound
        const applause = new Audio('https://www.soundjay.com/button/beep-04.wav'); // applause sound
        const celebration = new Audio('https://www.soundjay.com/button/beep-08.wav'); // celebration sound
        const gameOverAudio = new Audio('https://www.soundjay.com/button/beep-09.wav'); // game over sound

        // Audio control variable
        let audioEnabled = false;

        // Prompt the user for audio enablement
        function promptAudio() {
            ctx.fillStyle = '#fff';
            ctx.font = '20px Courier';
            ctx.textAlign = 'center';
            ctx.fillText('Click to enable audio, or press Enter to disable it.', 400, 100);
            ctx.fillText('Press Enter for no audio', 400, 130);
        }

        // Event listener for enabling/disabling audio
        c.addEventListener('click', () => {
            audioEnabled = true;
            ctx.clearRect(0, 0, 800, 200);
            startGame();
        });

        document.addEventListener('keydown', e => {
            if (e.code === 'Enter') {
                audioEnabled = false;
                ctx.clearRect(0, 0, 800, 200);
                startGame();
            }
        });

        function startGame() {
            let speed = 6, score = 0, high = 0, over = false, start = false;
            let obs = [], frame = 0, next = 100, biomeChange = 500;
            let fly = false, god = false, space = 0, last = 0;
            let keys = {u:false, d:false};
            
            const dino = {
                x: 50, y: 150, w: 44, h: 47, dy: 0, jump: false, leg: 0, ty: 150,

                update() {
                    if (fly) {
                        if (keys.u) this.ty = Math.max(20, this.ty - 12);
                        if (keys.d) this.ty = Math.min(150, this.ty + 12);
                        this.y += (this.ty - this.y) * 0.4;
                    } else {
                        this.dy += 0.6;
                        this.y += this.dy;
                        if (this.y >= 150) {
                            this.y = 150;
                            this.dy = 0;
                            this.jump = false;
                        }
                    }
                    if (this.y >= 150 && frame % 5 === 0) this.leg = 1 - this.leg;
                },
                
                draw() {
                    ctx.fillStyle = fly ? '#0BF' : '#535';
                    ctx.fillRect(this.x + 20, this.y, 22, 22);
                    ctx.fillRect(this.x + 35, this.y + 10, 7, 12);
                    ctx.fillRect(this.x + 35, this.y + 2, 15, 10);
                    ctx.fillStyle = '#fff';
                    ctx.fillRect(this.x + 45, this.y + 4, 3, 3);
                    ctx.fillStyle = fly ? '#0BF' : '#535';
                    ctx.fillRect(this.x + 10, this.y + 18, 12, 4);
                    ctx.fillRect(this.x, this.y + 16, 12, 4);
                    if (this.leg === 0) {
                        ctx.fillRect(this.x + 20, this.y + 22, 6, 10);
                        ctx.fillRect(this.x + 30, this.y + 22, 6, 10);
                    } else {
                        ctx.fillRect(this.x + 22, this.y + 22, 6, 10);
                        ctx.fillRect(this.x + 28, this.y + 22, 6, 10);
                    }

                    if (fly) {
                        ctx.fillStyle = '#F80';
                        ctx.font = '16px Courier';
                        ctx.fillText('FLIGHT!', this.x - 10, this.y - 10);
                    }
                }
            };

            // Define biomes and background visuals (clouds, sky, etc.)
            const clouds = [];
            for (let i = 0; i < 5; i++) {  // Decreased cloud count
                clouds.push({x: Math.random() * 800, y: Math.random() * 100, size: Math.random() * 40 + 20});
            }

            const shootingStars = [];
            function createShootingStar() {
                const x = Math.random() * 800;
                const y = Math.random() * 200;
                const length = Math.random() * 40 + 20;
                const speed = Math.random() * 2 + 2;
                shootingStars.push({ x, y, length, speed });
            }

            function drawClouds() {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                clouds.forEach(cloud => {
                    ctx.beginPath();
                    ctx.arc(cloud.x, cloud.y, cloud.size, 0, Math.PI * 2);
                    ctx.fill();
                    cloud.x -= 0.5; // Cloud movement speed
                    if (cloud.x < -cloud.size) {
                        cloud.x = 800 + cloud.size;
                    }
                });
            }

            function drawShootingStars() {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                shootingStars.forEach(star => {
                    ctx.beginPath();
                    ctx.moveTo(star.x, star.y);
                    ctx.lineTo(star.x - star.length, star.y + star.length);
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    star.x -= star.speed;
                    if (star.x < 0) shootingStars.splice(shootingStars.indexOf(star), 1);
                });
            }

            // Define background and day/night cycle
            let isNight = false;
            let currentBiome = "desert";
            function setBiomeAndBackground() {
                if (frame % 200 === 0) {
                    isNight = !isNight;
                    if (frame % biomeChange === 0) {
                        const biomes = ["desert", "snow", "forest", "tundra"];
                        currentBiome = biomes[Math.floor(Math.random() * biomes.length)];
                    }
                }

                if (isNight) {
                    ctx.fillStyle = '#001d2d'; // Dark night sky
                    ctx.fillRect(0, 0, 800, 200);
                    // Draw stars
                    for (let i = 0; i < 50; i++) {
                        const starX = Math.random() * 800;
                        const starY = Math.random() * 200;
                        ctx.fillStyle = '#fff';
                        ctx.beginPath();
                        ctx.arc(starX, starY, 1, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    if (Math.random() < 0.02) createShootingStar();
                    drawShootingStars();
                } else {
                    ctx.fillStyle = '#87CEEB'; // Day sky
                    ctx.fillRect(0, 0, 800, 200);
                }

                if (currentBiome === "desert") {
                    ctx.fillStyle = '#F4A300';
                    ctx.fillRect(0, 140, 800, 60);
                } else if (currentBiome === "snow") {
                    ctx.fillStyle = '#ADD8E6';
                    ctx.fillRect(0, 140, 800, 60);
                } else if (currentBiome === "forest") {
                    ctx.fillStyle = '#228B22';
                    ctx.fillRect(0, 140, 800, 60);
                } else if (currentBiome === "tundra") {
                    ctx.fillStyle = '#A9A9A9';
                    ctx.fillRect(0, 140, 800, 60);
                }

                drawClouds();
            }

            class Cactus {
                constructor() {
                    this.x = 800;
                    this.y = 152;
                    this.w = 30;
                    this.h = 45;
                }
                draw() {
                    ctx.fillStyle = '#2a6';
                    ctx.fillRect(this.x + 12, this.y, 10, this.h);
                    ctx.fillRect(this.x + 4, this.y + 10, 8, 20);
                    ctx.fillRect(this.x + 22, this.y + 15, 8, 18);
                }
                hits(d) {
                    return d.x < this.x + this.w - 5 && d.x + d.w - 5 > this.x &&
                           d.y < this.y + this.h - 5 && d.y + d.h - 5 > this.y;
                }
            }

            // Add your game loop and other logic here, including triggering sounds based on score

            function gameLoop() {
                ctx.clearRect(0, 0, 800, 200); 
                setBiomeAndBackground();

                // Dino movement and drawing logic
                dino.update();
                dino.draw();

                // Cactus and other obstacles handling
                next--;
                if (next <= 0) {
                    const cactusSpacing = [20, 30, 57, 64];
                    const spacing = cactusSpacing[Math.floor(Math.random() * cactusSpacing.length)];
                    obs.push(new Cactus());
                    next = spacing;
                }

                // Collision detection and game logic
                obs = obs.filter(o => {
                    o.x -= speed;
                    o.draw();
                    if (o.hits(dino)) {
                        over = true;
                        if (audioEnabled) gameOverAudio.play();
                    }
                    return o.x > -50;
                });

                // Audio triggers
                if (audioEnabled) {
                    if (score >= 1000 && score < 2000) applause.play();
                    else if (score >= 10000 && score < 20000) celebration.play();
                }

                requestAnimationFrame(gameLoop);
            }

            gameLoop();
        }

        promptAudio();
    </script>
</body>
</html>
